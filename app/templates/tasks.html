{% extends "base.html" %}
{% block title %}–ú–æ–∏ –∑–∞–¥–∞—á–∏ ‚Äî PingMeBot{% endblock %}

{% block content %}
<section class="new-task">
    <h2>–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h2>
    <form action="/web/tasks/create" method="post">
        <input type="text" name="title" placeholder="–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?" required>
        <textarea name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
        <label>
            –î–µ–¥–ª–∞–π–Ω:
            <input type="datetime-local" name="due_at">
        </label>

        <label>
            –ù–∞–ø–æ–º–Ω–∏—Ç—å –≤:
            <input type="datetime-local" name="remind_at">
        </label>

        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
    </form>
</section>

<section class="task-columns">
    <div class="column">
        <h2>–ù–æ–≤—ã–µ</h2>
        {% if tasks_pending %}
        <ul>
            {% for task in tasks_pending %}
            <li class="task-card">
                <a href="/web/tasks/{{ task.id }}/edit"
                   class="edit-btn"
                   title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É">
                    ‚úé
                </a>

                <form
                        action="/web/tasks/{{ task.id }}/delete"
                        method="post"
                        class="delete-form"
                        onsubmit="return confirm('–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –µ—â—ë –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É?');"
                >
                    <button type="submit" class="delete-btn" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É">
                        ‚úï
                    </button>
                </form>

                <strong>{{ task.title }}</strong>
                {% if task.description %}
                <div class="desc">{{ task.description }}</div>
                {% endif %}
                {% if task.due_at %}
                <div class="meta {% if task.due_at < now %}overdue{% endif %}">
                    –î–µ–¥–ª–∞–π–Ω: {{ task.due_at.strftime('%d.%m.%Y %H:%M') }}
                </div>
                {% endif %}

                {% if task.remind_at %}
                <div class="meta reminder">
                    üîî –ù–∞–ø–æ–º–Ω–∏—Ç—å: {{ task.remind_at.strftime('%d.%m.%Y %H:%M') }}
                </div>
                {% endif %}
                <form action="/web/tasks/{{ task.id }}/start" method="post" style="display:inline">
                    <button type="submit">–í–∑—è—Ç—å –≤ —Ä–∞–±–æ—Ç—É</button>
                </form>
                <form action="/web/tasks/{{ task.id }}/done" method="post" style="display:inline">
                    <button type="submit">–°–¥–µ–ª–∞–Ω–æ</button>
                </form>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á.</p>
        {% endif %}
    </div>


    <div class="column">
        <h2>–í —Ä–∞–±–æ—Ç–µ</h2>
        {% if tasks_in_progress %}
        <ul>
            {% for task in tasks_in_progress %}
            <li class="task-card">
                <a href="/web/tasks/{{ task.id }}/edit"
                   class="edit-btn"
                   title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É">
                    ‚úé
                </a>

                <form
                        action="/web/tasks/{{ task.id }}/delete"
                        method="post"
                        class="delete-form"
                        onsubmit="return confirm('–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –µ—â—ë –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É?');"
                >
                    <button type="submit" class="delete-btn" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É">
                        ‚úï
                    </button>
                </form>

                <strong>{{ task.title }}</strong>
                {% if task.description %}
                <div class="desc">{{ task.description }}</div>
                {% endif %}
                {% if task.due_at %}
                <div class="meta {% if task.due_at < now %}overdue{% endif %}">
                    –î–µ–¥–ª–∞–π–Ω: {{ task.due_at.strftime('%d.%m.%Y %H:%M') }}
                </div>
                {% endif %}

                {% if task.remind_at %}
                <div class="meta reminder">
                    üîî –ù–∞–ø–æ–º–Ω–∏—Ç—å: {{ task.remind_at.strftime('%d.%m.%Y %H:%M') }}
                </div>
                {% endif %}
                <form action="/web/tasks/{{ task.id }}/done" method="post" style="display:inline">
                    <button type="submit">–°–¥–µ–ª–∞–Ω–æ</button>
                </form>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>–ù–µ—Ç –∑–∞–¥–∞—á –≤ —Ä–∞–±–æ—Ç–µ.</p>
        {% endif %}
    </div>


    <div class="column">
        <h2>–ì–æ—Ç–æ–≤–æ</h2>
        {% if tasks_done %}
        <ul>
            {% for task in tasks_done %}
            <li class="task-card">
                <a href="/web/tasks/{{ task.id }}/edit"
                   class="edit-btn"
                   title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É">
                    ‚úé
                </a>

                <form
                        action="/web/tasks/{{ task.id }}/delete"
                        method="post"
                        class="delete-form"
                >
                    <button type="submit" class="delete-btn" title="–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É">
                        ‚úï
                    </button>
                </form>

                <strong>{{ task.title }}</strong>
                {% if task.description %}
                <div class="desc">{{ task.description }}</div>
                {% endif %}
                {% if task.due_at %}
                <div class="meta {% if task.due_at < now %}overdue{% endif %}">
                    –î–µ–¥–ª–∞–π–Ω: {{ task.due_at.strftime('%d.%m.%Y %H:%M') }}
                </div>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <p>–ì–æ—Ç–æ–≤—ã—Ö –∑–∞–¥–∞—á –ø–æ–∫–∞ –Ω–µ—Ç.</p>
        {% endif %}
    </div>
</section>
{% endblock %}
